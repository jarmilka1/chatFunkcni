<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <form action="/create-document" method="post">
        <label for="nazev">Název dokumentu:</label>
        <input type="text" id="nazev" name="nazev" required>

        <br>

        <label for="obsah">Obsah dokumentu:</label>
        <textarea id="obsah" name="obsah" rows="4" required></textarea>

        <br>

        <button type="submit">Vytvořit dokument</button>
    </form>

    <hr>

    <form id="updateForm">
        <label for="nazevUpdate">Název dokumentu k aktualizaci:</label>
        <input type="text" id="nazevUpdate" name="nazev" required>
      
        <br>
      
        <label for="obsahUpdate">Nový obsah dokumentu:</label>
        <textarea id="obsahUpdate" name="obsah" rows="4" required></textarea>
      
        <br>
      
        <button type="submit">Aktualizovat dokument</button>
      </form>
      

    <hr>

    <form id="deleteForm">
        <label for="nazevDelete">Název dokumentu k odstranění:</label>
        <input type="text" id="nazevDelete" name="nazev" required>

        <br>

        <button type="submit">Smazat dokument</button>
    </form>
    <hr>
    <form id="readForm">
        <label for="nazevRead">Název dokumentu k přečtení obsahu:</label>
        <input type="text" id="nazevRead" name="nazev" required>
      
        <br>
      
        <button type="submit">Přečíst obsah dokumentu</button>
      </form>
      
      <div id="obsahDokumentu"></div>
    
    <script>
        document.getElementById("updateForm").addEventListener("submit", function (event) {
            event.preventDefault();
            const nazev = document.getElementById("nazevUpdate").value;
            const obsah = document.getElementById("obsahUpdate").value;
            fetch(`/update-document/${nazev}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ obsah: obsah })
            })
                .then(response => {
                    if (response.ok) {
                        alert('Dokument byl úspěšně aktualizován');
                    } else {
                        alert('Chyba při aktualizaci dokumentu');
                    }
                });
        });

        document.getElementById("deleteForm").addEventListener("submit", function (event) {
            event.preventDefault();
            const nazev = document.getElementById("nazevDelete").value;
            fetch(`/delete-document/${nazev}`, {
                method: 'DELETE',
            })
                .then(response => {
                    if (response.ok) {
                        alert('Dokument byl úspěšně smazán');
                    } else {
                        alert('Chyba při mazání dokumentu');
                    }
                });
        });

        document.getElementById("readForm").addEventListener("submit", function (event) {
          event.preventDefault();
          const nazev = document.getElementById("nazevRead").value;
          fetch(`/read-document/${nazev}`)
            .then(response => {
              if (response.ok) {
                return response.text();
              } else {
                throw new Error('Chyba při čtení dokumentu');
              }
            })
            .then(data => {
              document.getElementById("obsahDokumentu").innerText = data;
            })
            .catch(error => {
              alert(error.message);
            });
        });
    </script>
</body>

</html>